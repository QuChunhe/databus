<?xml version="1.0" encoding="UTF-8" ?>

<configuration>

<publisher> 
    <client>
        <threadPoolSize>4</threadPoolSize>
        <connectionsPerThread>10</connectionsPerThread>
        <connectingListenersPerThread>256</connectingListenersPerThread>
    </client>
<!--
    <listener>
        <class>databus.listener.redis.RedisMessagingListener</class>
        <redis>
            <host>127.0.0.1</host>
            <port>6379</port>
            <keys>access,postback</keys>
        </redis>
    </listener>
     -->
    <listener>
        <class>databus.listener.mysql.MysqlListener</class>
        <mysql>
            <host>127.0.0.1</host>
            <port>3306</port>
            <user>root</user>
            <password>quchunhe</password>
            <serverId>1</serverId>
            <permittedTables>test.user</permittedTables>
            <binlogFileName>master-bin.000073</binlogFileName>
            <position>808</position>
        </mysql>
    </listener>  

    <!-- subscriber tag for no ActivePublisher -->
<!-- -->
    <subscriber>
        <topic>/MYSQL/1/test</topic>
        <host>127.0.0.1</host>
        <port>8765</port>
    </subscriber>
 
    <subscriber>
        <topic>/REDIS/LIST_MESSAGING/access</topic>
        <host>127.0.0.1</host>
        <port>8765</port>
    </subscriber>
    <subscriber>
        <topic>/REDIS/LIST_MESSAGING/postback</topic>
        <host>127.0.0.1</host>
        <port>8765</port>
    </subscriber>
</publisher>
  
<subscriber>
    <server>
        <host>127.0.0.1</host>
        <port>8765</port>
        <threadPoolSize>2</threadPoolSize>
    </server> 
  
    <receiver>
        <class>databus.receiver.redis.RedisSlave4Mysql</class>
        <remoteTopic>/MYSQL/1/test</remoteTopic>
        <redis>
            <host>127.0.0.1</host>
            <port>6379</port>
            <timeout>10</timeout>
            <maxTotal>10</maxTotal>
            <maxIdle>3</maxIdle>
            <minIdle>0</minIdle>
        </redis>
       <system>adm</system>
       <replicatedTables>
         <user>age, position, salary</user>
         <book>name, isdn, author</book>
       </replicatedTables>
    </receiver>
  <!--
    <receiver>
        <class>databus.receiver.mysql.MysqlReplication</class>
        <remoteTopic>/MYSQL/1/test</remoteTopic>
        <mysql>
            <url>jdbc:mysql://127.0.0.1:3308/test2</url>
            <username>root</username>
            <password>quchunhe</password>
            <driverClassName>com.mysql.jdbc.Driver</driverClassName>
            <initialSize>1</initialSize>
            <maxActive>10</maxActive>
            <maxIdle>5</maxIdle>
            <minIdle>0</minIdle>
            <maxWait>50000</maxWait>
            <defaultAutoCommit>true</defaultAutoCommit>
            <connectionProperties>useUnicode=true;characterEncoding=UTF-8</connectionProperties>
        </mysql>
    </receiver> 

    <receiver>
        <class>databus.receiver.mysql.MessagePersistence</class>
        <remoteTopic>127.0.0.2/REDIS/LIST_MESSAGING/access</remoteTopic>
        <remoteTopic>/REDIS/LIST_MESSAGING/postback</remoteTopic>
        <mysql>
            <url>jdbc:mysql://127.0.0.1:3308/test</url>
            <username>root</username>
            <password>quchunhe</password>
            <driverClassName>com.mysql.jdbc.Driver</driverClassName>
            <initialSize>1</initialSize>
            <maxActive>10</maxActive>
            <maxIdle>5</maxIdle>
            <minIdle>0</minIdle>
            <maxWait>50000</maxWait>
            <defaultAutoCommit>true</defaultAutoCommit>
            <connectionProperties>useUnicode=true;characterEncoding=UTF-8</connectionProperties>
        </mysql>
        <bean>
            <key>access</key>
            <class>adm.stats.AccessInfoBean</class>
        </bean>
        <bean>
            <key>postback</key>
            <class>adm.stats.PostbackInfoBean</class>
        </bean>
    </receiver>
   
    <receiver>
        <class>databus.receiver.DefaultReceiver</class>
        <remoteTopic>/REDIS/LIST_MESSAGING/access</remoteTopic>
        <remoteTopic>/REDIS/LIST_MESSAGING/postback</remoteTopic>
        <remoteTopic>/MYSQL/1/test</remoteTopic>
    </receiver>
 -->
</subscriber>

</configuration>
