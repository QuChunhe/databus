<?xml version="1.0" encoding="UTF-8" ?>

<configuration>

<publisher> 
    <class>databus.network.kafka.KafkaPublisher</class>
    <kafka>
        <server>127.0.0.1:9092</server>
        <acks>1</acks>        
    </kafka>

    <listener>
        <class>databus.listener.mysql.MysqlListener</class>
        <mysql>
            <host>127.0.0.1</host>
            <port>3307</port>
            <user>root</user>
            <password>quchunhe</password>
            <serverId>7</serverId>
            <permittedTables>test.user</permittedTables>
            <binlogFileName>master-bin.000001</binlogFileName>
            <position>120</position>
        </mysql>
        <topic>test/mysql2</topic>
<!--
        <filter>
            <class>databus.listener.mysql.IdModulusMysqlRowFilter</class>
            <id>1/3</id>
            <ignoredTables>test.user</ignoredTables>            
        </filter>
-->
        <filter>
            <class>databus.listener.mysql.DuplicateMysqlRowFilter</class>
            <expireAfterWrite>600</expireAfterWrite>
            <expireAfterAccess>1</expireAfterAccess>            
        </filter>
    </listener> 
</publisher>

<subscriber>
    <class>databus.network.kafka.KafkaSubscriber</class>
    <kafka>
        <consumerConfig>conf/kafka_consumer2.properties</consumerConfig>
        <maxWorkerThreadPoolSize>6</maxWorkerThreadPoolSize>
        <pollingTimeout>2000</pollingTimeout>
        <writePerFlush>1</writePerFlush>
        <taskCapacity>100</taskCapacity>
    </kafka> 

    <receiver>
        <class>databus.receiver.mysql.Master2MasterReplication</class>
        <remoteTopic>127.0.0.1:9092/test.mysql</remoteTopic>
        <mysql>
            <url>jdbc:mysql://127.0.0.1:3307/test</url>
            <username>root</username>
            <password>quchunhe</password>
            <driverClassName>com.mysql.jdbc.Driver</driverClassName>
            <initialSize>1</initialSize>
            <maxActive>10</maxActive>
            <maxIdle>5</maxIdle>
            <minIdle>0</minIdle>
            <maxWait>50000</maxWait>
            <defaultAutoCommit>true</defaultAutoCommit>
            <connectionProperties>useUnicode=true;characterEncoding=UTF-8</connectionProperties>
        </mysql>
    </receiver> 
</subscriber>

</configuration>
